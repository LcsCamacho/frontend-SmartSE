import styles from '@/styles/Home.module.scss'
import { Container, Divider, useMediaQuery } from '@mui/material';
import Head from 'next/head';
import { useEffect, useState } from 'react';
import { useDispatch, useSelector } from 'react-redux';
import Aside from '../../components/organisms/aside';
import Header from '../../components/organisms/header';
import ModalLogin from '../../components/organisms/modal-login';
import { openMobileMenuReducer } from '../../features/redux/mobile-menu-slice';
import HamburguerMenu from '../../components/icon-menu-mobile';
import { Dashboard } from '@mui/icons-material';


export default function Home() {
  const [windowReady, setWindowReady] = useState(false);
  const modalIsOpen = useSelector((state: any) => state.modal.isOpen);
  const showMobileMenu = useSelector((state: any) => state.mobileMenu.isOpen);
  const isMobile = useMediaQuery('(max-width:600px)');
  const dispatch = useDispatch();

  useEffect(() => {
    setWindowReady(true)
  }, [])


  useEffect(() => {
    if (!isMobile) {
      dispatch(openMobileMenuReducer())
    } 

  }, [windowReady, isMobile]);


  return (
    <>
      <Head>
        <title>Abastecimento App</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main className={styles.main}>
        {isMobile && !showMobileMenu && <HamburguerMenu />}
        {showMobileMenu && <Aside />}
        <Container> 
          <Header />
          <Divider />
          <DashboardCar/>
        </Container>
      </main>
      {modalIsOpen && <ModalLogin isOpen={modalIsOpen} />}
    </>
  )
}
